# 백엔드 서비스 정리 겸 코드 회고
> 백엔드 코드 작성과정을 되짚어보며 잘한 것과 개선이 필요한 것을 정리하자.

## 1. CRUD
이전 프리프로젝트와 직전에 했던 개인프로젝트를 통해서  
CRUD작성만큼은 쉽게 할 수 있을거라 생각했다.  
하지만 여기서 크게 두가지 걸림돌이 있었다.  

    1. 쓸모없는 엔티티  
    Pet은 Member없이 존재할 수 없다. 정확하게는 존재할 필요가 없다.  
    우리 서비스는 '반려견'의 산책이니까  
    하지만 당연스럽게 Pet엔티티를 만들었고 연관관계를 매핑했는데 멘토분에게  
    '회원에 항상 따라오는 강아지가 굳이 엔티티여야할 필요가 있나요?'  
    라는 말을 듣고 아무 말도 할 수 없었다. 엔티티 필요 여부를 떠나서 그런 고민을 하지않았기때문이었다.  
    결론적으로는 필요했다. 회원이 강아지를 가진 형태긴하지만 많은 요청이 강아지를 기준으로 이루어지기 때문이다.  
    CRUD가 쉽다 어렵다를 떠나서 프로그램의 틀인만큼 중요하다. 따라서 작성에도 충분한 고민이 있어야함을 알게되었다.  
    DB에 대한 이해 부족이라 생각한다.  
    그리고 공지사항역시 엔티티로 뒀으나, 공지사항은 단 하나만 있으면 된다는 것을 최근에 알게되었다.  
    즉 연관관계 매핑을 할 필요도, 엔티티를 만들 필요도 없었다.  

    2. DTO 매핑  
    이전에는 직접 메서드를 만들어서 엔티티와 DTO를 매핑했는데 메인 프로젝트를 하면서 맵스트럭터를 이용해서 매핑을 했다.  
    대부분 자동으로 매핑해주고, 복잡한 로직도 설정하면 빌드하면서 매핑메서드를 자동으로 생성해줘서 좋은 툴인데  
    사용이 익숙치 않아서 일부는 수동으로 구현하다보니 이도저도 아니게 되었다.  
    또 직접 구현하면서 매퍼에게 어느정도 역할을 맡겼던 것들을 서비스로직에서 담당시키다보니  
    중간중간 Dto매핑과 관련한 오류를 많이 만났다.  
    그래도 사용예정이 없던 맵스트럭터에 대해 알아보면서 사용하는 이유와 함께 사용하지 않는 이유도 분명히 하는것이 좋다고 느꼈다.  
    맵스트럭터에대해 좀 더 공부해서 더 편리하게 사용할 수 있는 방법과 발생할 수 있는 단점에대해 공부해야겠다.  

## 2. 연관관계 매핑  
@OneToMany, @ManyToOne 만 잘하면 될줄 알았다.  
하지만 JPA전체에 대한 이해 부족을 통감했다.  
이것저것 적을 필요 없이 연관관계 매핑을 하면서 맞닥뜨린 오류들은 모두 JPA에 대한 이해부족이었다.  
다대다는 물론이고 애초에 데이터에대한 고려가 없었다. 

## 3. 시큐리티  
프리프로젝트에서 열심히 구현한게 있어서 이번에는 조금 빠르게, 무리없이 할 수 있었다.  
하지만 OAuth2를 적용하면서 예외핸들링이 필요했는데 다른 클래스와 동일한 방식으로 하려했는데  
전혀 동작하지않았다. 알고보니 시큐리티는 기존 예외처리의 바깥 영역에있어서 닿지않는 영역에 있었다.  
이와 관련된 것은 [시큐리티 예외핸들링](220923.md)에서 다루었다.  
시큐리티 공부를 하면서 사용 측면에서만 공부했는데 전체 시스템에 대한 이해가 왜 필요한지 깨닫는 계기가 되었다.  

## 4. 서비스로직들  


## 5. 배포


