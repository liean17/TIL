# 메인 프로젝트
## 오늘 할 일
- 검색,조회 구현

---

### 트러블 슈팅
- 시큐리티에서 예외 핸들링  
엑세스 토큰 만료와 관련해서 오류를 표시해야했다.  
만료시 임의로 설정한 예외코드와 설명이 나오도록 설정했는데, 콘솔에서는 예외메세지가 제대로 출력되지만 응답은 500이나 403등 다른 오류가 났다.
처음에는 exceptionHandler와 예외 처리코드들이 잘못 작성되었다고 생각했는데  
그렇게 복잡하지 않은 코드라서 오류가 발생할만한 것들은 보이지 않았다.  
그래서 혹시나 시큐리티와 관련해서 오류를 알아서 처리해버리는게 아닌지 테스트해보니 시큐리티 이외에서 발생한 예외는 정상적으로 출력되는 것을 확인했다.  
즉 시큐리티내의 예외는 다르게 처리해야한다는 것이다.  
    - [참고한 블로그](https://velog.io/@hellonayeon/spring-boot-jwt-expire-exception)  
    시큐리티의 Filter는 Dispatcher Servlet보다도 앞단에 있어서 Filter에서 발생하는 예외는 exceptionHandler가 처리할 수 없다.  
    그래서 예외를 처리하는 필터를 만들어서 예외가 발생하는 필터앞단에 위치하도록 해야 그 뒤에 발생하는 예외를 처리할 수 있다.  
    그리고 예외를 반환하는것에도 주의해야하는데 response에 응답을 직접 세팅해줘야한다. 즉, 객체를 그대로 반환해봤자 아무것도 뜨지않는다 즉 직접 Json형태로 파싱해서 String타입으로 출력해야한다.  
    직접해야하나 고민하던차에 객체를 Json형식으로 파싱해주는 라이브러리를 찾아서 적용했다.  
    시큐리티관련 설정도 해주고나니 정상적으로 예외가 출력된다!  
    시큐리티를 넘어서 요청과 응답 전체 과정에 대한 이해 부족이었다고 생각한다.  
    이번기회에 과정에 대해 많은 학습을 할 수 있었다.

- [미해결] 이미지  
이미지와 dto 즉 json파일을 보내려면 form/data타입으로 보내야하는데  
이것을 프론트단에서 처리하는게 굉장히 까다로운 듯 했다.  
그래서 이미지를 따로 저장해서 경로만 전달하는 방식을 구현하려하는데 제대로 될지 모르겠다.
---

### 후기
- 