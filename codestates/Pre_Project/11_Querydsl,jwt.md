# 사전 프로젝트
## Querydsl을 사용한 검색정렬과 jwt로그인
---
### 학습을 앞두고
- 등록삭제는 모두 가능해졌고 검색과 정렬기능, 그리고 시큐리티 도입이 남았다.  
시큐리티는 jwt와 함께해야할것같다. 기존 방식이 제대로 동작하지 않기때문이다. 아마 찾아보면 정말 많은 자료가 있지 싶다.  

### 트러블 슈팅
- jwt문제  
코드스테이츠를 보고 따라하면서 문제없이 구현에 성공했으나 뭔가 제대로 동작하지않았다.  
일단 ROLE을 빼고 만들었더니 모든게 제대로 동작하는데 이상하게 요청할때마다 403 Forbidden에러가 떴다.  
그래서 권한문제구나 싶어서 다시 ROLE을 구현했더니 이번엔 요청이 올바르지 않다고 한다.  
두 문제 모두 검색해봐도 해결책은 이미 내가 하고있는 방법들이었다.  
검색이 올바르지않은건지, 내가 겪은 문제는 많은 사람이 겪은것이라곤하지만 그걸 찾아내기가 힘들다.  
여러모로 트러블 슈팅이 중요한것같다.  
: 해결  
스프링시큐리티의 체인필터와 토큰사이의 오류라고한다. 그래서 config파일에 설정을 좀 해줘야했다.  
늦게까지 해결책을 찾다가 다음날로 미뤘는데 그사이 다른분이 찾아보셔서 해결하게되었는데  
내가 찾아본 자료에도 비슷한 설명이 있긴했다. 하지만 대수롭지않게 넘어갔는데 그걸 조금만 더 검색하니 나온것이다.  
검색을 하는것도 대놓고 알아볼게아니라 생각을 깊이해야겠다.
---
### 할 일
- [x] 질문,태그 검색 및 정렬 구현
- [] jwt구현
- [] 데이터베이스 변경

---
### 아이디어
- 응답헤더의 토큰을 넘겨주기   
나는 토큰이 응답헤더에 나오기만하면 성공이라 생각하고 나머진 프론트가 알아서하나보다 생각했는데  
수보님과 연락해보니 요청할때 헤더를 가져오는 방법들이 있었다.  
자세하게 보지는 못했지만 필터에서 헤더를 검사해서 PrincipalDetails에 넣고 요청마다 찾아내는 방식이었다.  
직접적이진않지만 도움을 드려서 질문할 수 있는 권한을 얻게되었으니 열심히 물어봐야겠다.  

### 후기
- 코드오류  
앞서말한대로 수보님께 연락이왔는데 jwt관련해서 요청이 두번 이루어지는 오류가있으시다고 했다.  
나는 그렇진않아서 내 코드를 보여드리다 같은 오류가 있다는 것을 코드스테이츠 전체채널에서봐서 공유해드렸다.  
알고보니 문제는 코드스테이츠에서 제공하는 레퍼런스 코드자체에 문제가 있었다.  
어떻게보면 잘못가르쳐준것이다. 나도 문제에 부딪힐때마다 내 공부가 부족한 탓이겠지 생각했는데  
내가 지금 참고하고있는 코드들도 올바른지 계속 확인할 필요가 있을 것 같다.  
그런데 나도 오류가 나는 부분을 똑같이 쳤는데 문제가없다.  
아니 왜 되지?

